
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../lab-4-bing_search/">
      
      
        <link rel="next" href="../finishing-up/">
      
      
      <link rel="icon" href="../media/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Lab 5 Multilingual Visualizations - Build your code-first agent with Azure AI Foundry</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Build your code-first agent with Azure AI Foundry" class="md-header__button md-logo" aria-label="Build your code-first agent with Azure AI Foundry" data-md-component="logo">
      
  <img src="../media/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Build your code-first agent with Azure AI Foundry
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 5 Multilingual Visualizations
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 2c-1.82 0-3.53.5-5 1.35C8 5.08 10 8.3 10 12s-2 6.92-5 8.65C6.47 21.5 8.18 22 10 22a10 10 0 0 0 10-10A10 10 0 0 0 10 2"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="amber" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Build your code-first agent with Azure AI Foundry" class="md-nav__button md-logo" aria-label="Build your code-first agent with Azure AI Foundry" data-md-component="logo">
      
  <img src="../media/favicon.png" alt="logo">

    </a>
    Build your code-first agent with Azure AI Foundry
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solution Architecture
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Considerations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab-1-function_calling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 1 Function Calling Power
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab-2-file_search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 2 Grounding with Documents
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab-3-code_interpreter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 3 Intro to the Code Interpreter
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../lab-4-bing_search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 4 Grounding with Bing Search
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lab 5 Multilingual Visualizations
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lab 5 Multilingual Visualizations
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      Lab Exercise
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rerun-the-previous-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Rerun the previous lab
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-multilingual-font-support" class="md-nav__link">
    <span class="md-ellipsis">
      Add Multilingual Font Support
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-the-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Review the Instructions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-agent-app" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Agent App
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-the-code-interpreter" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging the Code Interpreter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restricting-code-interpreter-output" class="md-nav__link">
    <span class="md-ellipsis">
      Restricting Code Interpreter Output
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stop-the-agent-app" class="md-nav__link">
    <span class="md-ellipsis">
      Stop the Agent App
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../finishing-up/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab 6 Finishing Up
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Summary
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Resources
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      Lab Exercise
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rerun-the-previous-lab" class="md-nav__link">
    <span class="md-ellipsis">
      Rerun the previous lab
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-multilingual-font-support" class="md-nav__link">
    <span class="md-ellipsis">
      Add Multilingual Font Support
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#review-the-instructions" class="md-nav__link">
    <span class="md-ellipsis">
      Review the Instructions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-agent-app" class="md-nav__link">
    <span class="md-ellipsis">
      Run the Agent App
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-the-code-interpreter" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging the Code Interpreter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restricting-code-interpreter-output" class="md-nav__link">
    <span class="md-ellipsis">
      Restricting Code Interpreter Output
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stop-the-agent-app" class="md-nav__link">
    <span class="md-ellipsis">
      Stop the Agent App
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Lab 5 Multilingual Visualizations</h1>

<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>In the Grounding with Documents lab, we uploaded a PDF file to provide context for conversations. Now, we’ll enhance the Code Interpreter by uploading a ZIP file with fonts for multilingual visualizations—just one example of how <a href="https://learn.microsoft.com/azure/ai-services/agents/how-to/tools/code-interpreter" target="_blank">file uploads</a> can extend its functionality.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Code Interpreter includes a default set of Latin-based fonts. Since the Code Interpreter runs in a sandboxed Python environment, it can’t download fonts directly from the internet.</p>
</div>
<h2 id="lab-exercise">Lab Exercise<a class="headerlink" href="#lab-exercise" title="Permanent link">&para;</a></h2>
<p>Earlier labs didn’t include multilingual support because uploading the required font ZIP file and linking it to the Code Interpreter is time-consuming. In this lab, we’ll enable multilingual support by uploading the necessary fonts. You’ll also learn some tips on how to guide the Code Interpreter using extended instructions.</p>
<h2 id="rerun-the-previous-lab">Rerun the previous lab<a class="headerlink" href="#rerun-the-previous-lab" title="Permanent link">&para;</a></h2>
<p>First, we're going to rerun the previous lab so we can see how the Code Interpreter supports multilingual text.</p>
<ol>
<li>Start the agent app by pressing <kbd>F5</kbd>.</li>
<li>In the terminal, the app will start, and the agent app will prompt you to  <strong>Enter your query</strong>.</li>
<li>
<p>Try these questions:</p>
<ol>
<li><strong>What were the sales by region for 2022</strong></li>
<li><strong>In Korean</strong></li>
<li><strong>Show as a pie chart</strong></li>
</ol>
</li>
</ol>
<p>Once the task is complete, the pie chart image will be saved in the <strong>shared/files</strong> subfolder. Review the visualization, and you'll see that the text is not rendered correctly. This is because the Code Interpreter doesn't have the necessary fonts to render non-Latin characters.</p>
<p><a class="glightbox" href="../media/sales_by_region_2022_pie_chart_korean.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="The image shows korean pie chart without Korean text" src="../media/sales_by_region_2022_pie_chart_korean.png" width="75%" /></a></p>
<ol>
<li>When you're done, type <strong>exit</strong> to clean up the agent resources and stop the app.</li>
</ol>
<h2 id="add-multilingual-font-support">Add Multilingual Font Support<a class="headerlink" href="#add-multilingual-font-support" title="Permanent link">&para;</a></h2>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Python</label><label for="__tabbed_1_2">C#</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p>Open the <code>main.py</code>.</p>
</li>
<li>
<p>Define a new instructions file for our agent: <strong>uncomment</strong> the following lines by removing the <strong>"# "</strong> characters</p>
<div class="highlight"><pre><span></span><code><span class="n">INSTRUCTIONS_FILE</span> <span class="o">=</span> <span class="s2">&quot;instructions/code_interpreter_multilingual.txt&quot;</span>

<span class="n">font_file_info</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">project_client</span><span class="p">,</span> <span class="n">utilities</span><span class="o">.</span><span class="n">shared_files_path</span> <span class="o">/</span> <span class="n">FONTS_ZIP</span><span class="p">)</span>
<span class="n">code_interpreter</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="n">file_id</span><span class="o">=</span><span class="n">font_file_info</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The lines to be uncommented are not adjacent. When removing the # character, ensure you also delete the space that follows it.</p>
</div>
</li>
<li>
<p>Review the code in the <code>main.py</code> file.</p>
<p>After uncommenting, your code should look like this:</p>
<div class="highlight"><pre><span></span><code><span class="n">INSTRUCTIONS_FILE</span> <span class="o">=</span> <span class="s2">&quot;instructions/function_calling.txt&quot;</span>
<span class="n">INSTRUCTIONS_FILE</span> <span class="o">=</span> <span class="s2">&quot;instructions/file_search.txt&quot;</span>
<span class="n">INSTRUCTIONS_FILE</span> <span class="o">=</span> <span class="s2">&quot;instructions/code_interpreter.txt&quot;</span>
<span class="n">INSTRUCTIONS_FILE</span> <span class="o">=</span> <span class="s2">&quot;instructions/bing_grounding.txt&quot;</span>
<span class="n">INSTRUCTIONS_FILE</span> <span class="o">=</span> <span class="s2">&quot;instructions/code_interpreter_multilingual.txt&quot;</span>


<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">add_agent_tools</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add tools for the agent.&quot;&quot;&quot;</span>
    <span class="n">font_file_info</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Add the functions tool</span>
    <span class="n">toolset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">functions</span><span class="p">)</span>

    <span class="c1"># Add the code interpreter tool</span>
    <span class="n">code_interpreter</span> <span class="o">=</span> <span class="n">CodeInterpreterTool</span><span class="p">()</span>
    <span class="n">toolset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">code_interpreter</span><span class="p">)</span>

    <span class="c1"># Add the tents data sheet to a new vector data store</span>
    <span class="n">vector_store</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">create_vector_store</span><span class="p">(</span>
        <span class="n">project_client</span><span class="p">,</span>
        <span class="n">files</span><span class="o">=</span><span class="p">[</span><span class="n">TENTS_DATA_SHEET_FILE</span><span class="p">],</span>
        <span class="n">vector_store_name</span><span class="o">=</span><span class="s2">&quot;Contoso Product Information Vector Store&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">file_search_tool</span> <span class="o">=</span> <span class="n">FileSearchTool</span><span class="p">(</span><span class="n">vector_store_ids</span><span class="o">=</span><span class="p">[</span><span class="n">vector_store</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
    <span class="n">toolset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">file_search_tool</span><span class="p">)</span>

    <span class="c1"># Add multilingual support to the code interpreter</span>
    <span class="n">font_file_info</span> <span class="o">=</span> <span class="k">await</span> <span class="n">utilities</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">project_client</span><span class="p">,</span> <span class="n">utilities</span><span class="o">.</span><span class="n">shared_files_path</span> <span class="o">/</span> <span class="n">FONTS_ZIP</span><span class="p">)</span>
    <span class="n">code_interpreter</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="n">file_id</span><span class="o">=</span><span class="n">font_file_info</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="c1"># Add the Bing grounding tool</span>
    <span class="n">bing_connection</span> <span class="o">=</span> <span class="k">await</span> <span class="n">project_client</span><span class="o">.</span><span class="n">connections</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">connection_name</span><span class="o">=</span><span class="n">BING_CONNECTION_NAME</span><span class="p">)</span>
    <span class="n">bing_grounding</span> <span class="o">=</span> <span class="n">BingGroundingTool</span><span class="p">(</span><span class="n">connection_id</span><span class="o">=</span><span class="n">bing_connection</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="n">toolset</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">bing_grounding</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">font_file_info</span>
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p>Open the <code>Program.cs</code> file.</p>
</li>
<li>
<p><strong>Update</strong> the creation of the lab to use the <code>Lab5</code> class.</p>
<div class="highlight"><pre><span></span><code><span class="k">await</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="nn">Lab</span><span class="w"> </span><span class="n">lab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Lab5</span><span class="p">(</span><span class="n">projectClient</span><span class="p">,</span><span class="w"> </span><span class="n">apiDeploymentName</span><span class="p">);</span>
</code></pre></div>
</li>
<li>
<p>Review the <code>Lab5.cs</code> class to see how the Code Interpreter is added to the Tools list.</p>
</li>
</ol>
</div>
</div>
</div>
<h2 id="review-the-instructions">Review the Instructions<a class="headerlink" href="#review-the-instructions" title="Permanent link">&para;</a></h2>
<ol>
<li>Open the <strong>shared/instructions/code_interpreter_multilingual.txt</strong> file. This file replaces the instructions used in the previous lab.</li>
<li>
<p>The <strong>Tools</strong> section now includes an extended “Visualization and Code Interpretation” section describing how to create visualizations and handle non-Latin languages.</p>
<p>The following is a summary of the instructions given to the Code Interpreter:</p>
<ul>
<li><strong>Font Setup for Non-Latin Scripts (e.g., Arabic, Japanese, Korean, Hindi):</strong><ul>
<li>On first run, verify if the <code>/mnt/data/fonts</code> folder exists. If missing, unzip the font file into this folder.</li>
</ul>
</li>
<li>
<p><strong>Available Fonts:</strong></p>
<ul>
<li>Arabic: <code>CairoRegular.ttf</code></li>
<li>Hindi: <code>NotoSansDevanagariRegular.ttf</code></li>
<li>Korean: <code>NanumGothicRegular.ttf</code></li>
<li>Japanese: <code>NotoSansJPRegular.ttf</code></li>
</ul>
</li>
<li>
<p><strong>Font Usage:</strong></p>
<ul>
<li>Load the font with <code>matplotlib.font_manager.FontProperties</code> using the correct path.</li>
<li>Apply the font to:<ul>
<li><code>plt.title()</code> using the <code>fontproperties</code> parameter.</li>
<li>All labels and text using <code>textprops={'fontproperties': font_prop}</code> in functions like <code>plt.pie()</code> or <code>plt.bar_label()</code>.</li>
</ul>
</li>
<li>Ensure all text (labels, titles, legends) is properly encoded, without boxes or question marks.</li>
</ul>
</li>
<li>
<p><strong>Visualization Text:</strong></p>
<ul>
<li>Always translate the data to the requested or inferred language (e.g., Chinese, French, English).</li>
<li>Use the appropriate font from <code>/mnt/data/fonts/fonts</code> for all chart text (e.g., titles, labels).</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="run-the-agent-app">Run the Agent App<a class="headerlink" href="#run-the-agent-app" title="Permanent link">&para;</a></h2>
<ol>
<li>Press <kbd>F5</kbd> to run the app.</li>
<li>In the terminal, the app will start, and the agent app will prompt you to  <strong>Enter your query</strong>.</li>
</ol>
<h3 id="start-a-conversation-with-the-agent">Start a Conversation with the Agent<a class="headerlink" href="#start-a-conversation-with-the-agent" title="Permanent link">&para;</a></h3>
<p>Try these questions:</p>
<ol>
<li><strong>What were the sales by region for 2022</strong></li>
<li><strong>In Korean</strong></li>
<li>
<p><strong>Show as a pie chart</strong></p>
<p>Once the task is complete, the pie chart image will be saved in the <strong>shared/files</strong> subfolder.</p>
<p><a class="glightbox" href="../media/sales_by_region_pie_chart_korean_font.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="The image shows korean pie chart with Korean text" src="../media/sales_by_region_pie_chart_korean_font.png" width="75%" /></a></p>
</li>
</ol>
<h2 id="debugging-the-code-interpreter">Debugging the Code Interpreter<a class="headerlink" href="#debugging-the-code-interpreter" title="Permanent link">&para;</a></h2>
<p>You can’t directly debug the Code Interpreter, but you can gain insight into its behavior by asking the agent to display the code it generates. This helps you understand how it interprets your instructions and can guide you in refining them.</p>
<p>From the terminal, type:</p>
<ol>
<li><strong>show code</strong> to see the code generated by the Code Interpreter for the last visualization.</li>
<li><strong>list files mounted at /mnt/data</strong> to see the files uploaded to the Code Interpreter.</li>
</ol>
<h2 id="restricting-code-interpreter-output">Restricting Code Interpreter Output<a class="headerlink" href="#restricting-code-interpreter-output" title="Permanent link">&para;</a></h2>
<p>In a production environment, you likely don’t want end users to see the code generated by the Code Interpreter or access uploaded or created files. To prevent this, add instructions to restrict the Code Interpreter from displaying code or listing files.</p>
<p>For example, you can insert the following instructions at the beginning of the <code>2. Visualization and Code Interpretation</code> section in the <code>code_interpreter_multilingual.txt</code> file.</p>
<div class="highlight"><pre><span></span><code>- Never show the code you generate to the user.
- Never list the files mounted at /mnt/data.
</code></pre></div>
<h2 id="stop-the-agent-app">Stop the Agent App<a class="headerlink" href="#stop-the-agent-app" title="Permanent link">&para;</a></h2>
<p>When you're done, type <strong>exit</strong> to clean up the agent resources and stop the app.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../lab-4-bing_search/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Lab 4 Grounding with Bing Search">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Lab 4 Grounding with Bing Search
              </div>
            </div>
          </a>
        
        
          
          <a href="../finishing-up/" class="md-footer__link md-footer__link--next" aria-label="Next: Lab 6 Finishing Up">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Lab 6 Finishing Up
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.footer", "content.code.copy", "navigation.tabs.sticky", "content.tabs.link"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../js/custom-nav.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>